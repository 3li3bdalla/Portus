language: ruby
rvm:
  - 2.5.0

before_install:
  - sudo update-ca-certificates

  - curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -
  - echo "deb https://dl.yarnpkg.com/debian/ stable main" | sudo tee /etc/apt/sources.list.d/yarn.list
  - sudo apt-get update
  - sudo apt-get install yarn
  - yarn install

script:
  # Build && test
  - chmod+x bin/build.sh && ./bin/build.sh

  # Lint
  - yarn eslint
  - bundle exec rubocop

env:
  global:
    - NOKOGIRI_USE_SYSTEM_LIBRARIES=true

addons:
  apt:
    packages:
    - libcurl4-openssl-dev # required to avoid SSL errors
