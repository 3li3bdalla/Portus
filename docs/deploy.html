<!DOCTYPE html>
<html>
  <head>
    <title>Deploying Portus</title>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="  Some of the statements from this page rely on Portus 2.3 or  later.">

    <link href="/stylesheets/portus.css"  type="text/css" rel="stylesheet" />
    <script src="/javascripts/dist/portus.min.js" type="text/javascript" charset="utf-8"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
  <script src="//oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script src="//oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- Favicon for all different devices -->
<meta content="width=device-width, initial-scale=1" name="viewport" />
<link href="/images/favicon/apple-touch-icon-57x57.png" rel="apple-touch-icon" sizes="57x57" />
<link href="/images/favicon/apple-touch-icon-60x60.png" rel="apple-touch-icon" sizes="60x60" />
<link href="/images/favicon/apple-touch-icon-72x72.png" rel="apple-touch-icon" sizes="72x72" />
<link href="/images/favicon/apple-touch-icon-76x76.png" rel="apple-touch-icon" sizes="76x76" />
<link href="/images/favicon/apple-touch-icon-114x114.png" rel="apple-touch-icon" sizes="114x114" />
<link href="/images/favicon/apple-touch-icon-120x120.png" rel="apple-touch-icon" sizes="120x120" />
<link href="/images/favicon/apple-touch-icon-144x144.png" rel="apple-touch-icon" sizes="144x144" />
<link href="/images/favicon/apple-touch-icon-152x152.png" rel="apple-touch-icon" sizes="152x152" />
<link href="/images/favicon/apple-touch-icon-180x180.png" rel="apple-touch-icon" sizes="180x180" />
<link href="/images/favicon/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png" />
<link href="/images/favicon/android-chrome-192x192.png" rel="icon" sizes="192x192" type="image/png" />
<link href="/images/favicon/favicon-96x96.png" rel="icon" sizes="96x96" type="image/png" />
<link href="/images/favicon/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png" />
<link href="/images/favicon/manifest.json" rel="manifest" />
<link color="#205683" href="/images/favicon/safari-pinned-tab.svg" rel="mask-icon" />
<link href="/images/favicon/favicon.ico" rel="shortcut icon" />
<meta content="Portus" name="apple-mobile-web-app-title" />
<meta content="Portus" name="application-name" />
<meta content="#da532c" name="msapplication-TileColor" />
<meta content="/images/favicon/mstile-144x144.png" name="msapplication-TileImage" />
<meta content="/images/favicon/browserconfig.xml" name="msapplication-config" />
<meta content="#205683" name="theme-color" />

  </head>
  <body>
    <header id="portus-header" class="portus-topbar">
  <div class="container-fluid">
    <i id="open_main_menu" class="fa fa-bars fa-2x visible-xs menu-sandwich"></i>

    <a href="/">
      <img class="pull-left img-responsive topbar-logo" src="/images/logo-header.png" alt="Logo on header">
    </a>
    <div class="pull-right hidden-xs">
      <a class="btn btn-link" href="/blog/index.html">Blog</a>
      <a class="btn btn-link" href="/features.html">Features</a>
      <a class="btn btn-link" href="/documentation.html">Documentation</a>
    </div>
    <div class="clearfix"></div>
  </div>
</header>

<div id="mobile-menu" class="visible-xs mobile-menu">
  <ul>
    <li><i class="fa fa-list-ul"></i><a class="btn btn-link" href="/features.html">Features</a></li>
    <li><i class="fa fa-book"></i><a class="btn btn-link" href="/documentation.html">Documentation</a></li>
    <li><i class="fa fa-newspaper-o"></i><a class="btn btn-link" href="/blog/index.html">Blog</a></li>
    <li><i class="fa fa-question-circle"></i><a class="btn btn-link" href="/docs/FAQ.html">FAQ</a></li>
  </ul>
</div>

    <div class="container" id="documentation">
      <div class="row">
        <div class="post-content col-md-10 col-md-offset-3 col-sm-12 col-xs-12">
          <section>
            <div class="row">
              <div class="visible-xs visible-sm">
  <div class="content-bar">
    <ul class="topics">
      <li class="dropdown">
        <button class="dropdown-toggle" type="button" data-toggle="dropdown">Documentation Index
        <span class="caret"></span></button>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Documentation</li>
          
          
            <li>
              <a href="/docs/first-steps.html">
                Docker and Portus for newcomers
              </a>
            </li>
          
            <li>
              <a href="/docs/Configuring-Portus.html">
                Configuring Portus
              </a>
            </li>
          
            <li>
              <a href="/docs/database.html">
                Configuring the database
              </a>
            </li>
          
            <li>
              <a href="/docs/How-to-setup-secure-registry.html">
                Configuring a secure private registry
              </a>
            </li>
          
            <li>
              <a href="/docs/deploy.html">
                Deploying Portus
              </a>
            </li>
          
            <li>
              <a href="/docs/Configuring-the-registry.html">
                Portus and your private registry
              </a>
            </li>
          
            <li>
              <a href="/docs/assets.html">
                Managing assets
              </a>
            </li>
          
            <li>
              <a href="/docs/secrets.html">
                Using secrets
              </a>
            </li>
          
            <li>
              <a href="/docs/API.html">
                Portus REST API
              </a>
            </li>
          
            <li>
              <a href="/docs/background.html">
                The background process
              </a>
            </li>
          
            <li>
              <a href="/docs/portusctl.html">
                portusctl
              </a>
            </li>
          
            <li>
              <a href="/docs/upgrading-portus.html">
                Upgrading Portus
              </a>
            </li>
          
            <li>
              <a href="/docs/versions.html">
                Supported Docker Versions
              </a>
            </li>
          
            <li>
              <a href="/docs/debugging.html">
                Debugging Portus
              </a>
            </li>
          
            <li>
              <a href="/docs/how_we_release.html">
                Portus Releases
              </a>
            </li>
          
            <li>
              <a href="/docs/migrate-from-rpm.html">
                Migrating from the RPM
              </a>
            </li>
          
            <li>
              <a href="/docs/release-schedule.html">
                Release schedule
              </a>
            </li>
          
            <li>
              <a href="/docs/FAQ.html">
                FAQ
              </a>
            </li>
          
          <li class="dropdown-header">Features</li>
          
          
            <li>
              <a href="/features/1_Synchronizing-the-Registry-and-Portus.html">
                Synchronizing the Registry and Portus
              </a>
            </li>
          
            <li>
              <a href="/features/2_LDAP-support.html">
                LDAP support
              </a>
            </li>
          
            <li>
              <a href="/features/3_teams_namespaces_and_users.html">
                Teams, namespaces and users
              </a>
            </li>
          
            <li>
              <a href="/features/4_audit.html">
                Audit
              </a>
            </li>
          
            <li>
              <a href="/features/5_search.html">
                Search
              </a>
            </li>
          
            <li>
              <a href="/features/6_security_scanning.html">
                Security scanning
              </a>
            </li>
          
            <li>
              <a href="/features/removing_images.html">
                Removing images and tags
              </a>
            </li>
          
            <li>
              <a href="/features/6_starring.html">
                Starring repositories
              </a>
            </li>
          
            <li>
              <a href="/features/7_disabling_users.html">
                Removing/Disabling users
              </a>
            </li>
          
            <li>
              <a href="/features/anonymous_browsing.html">
                Anonymous browsing
              </a>
            </li>
          
            <li>
              <a href="/features/8_locking.html">
                Locking accounts for safety reasons
              </a>
            </li>
          
            <li>
              <a href="/features/9_recovering_password.html">
                Recovering the password
              </a>
            </li>
          
            <li>
              <a href="/features/disabling_signup.html">
                Disabling the sign up form
              </a>
            </li>
          
            <li>
              <a href="/features/oauth.html">
                OAuth and OpenID Connect support
              </a>
            </li>
          
            <li>
              <a href="/features/application_tokens.html">
                Application tokens
              </a>
            </li>
          
            <li>
              <a href="/features/display_name.html">
                Display name
              </a>
            </li>
          
            <li>
              <a href="/features/health.html">
                Health checking
              </a>
            </li>
          
        </ul>
      </li>
    </ul>
  </div>
</div>

            </div>
            <div class="row post">
              <article>
                <div class="alert alert-info">
  Some of the statements from this page rely on Portus <strong>2.3 or
  later</strong>.
</div>

<h2 id="containerized">Containerized</h2>

<h3 id="docker">Docker</h3>

<p>The <strong>recommended</strong> way to deploy Portus is with the <a href="https://hub.docker.com/r/opensuse/portus/">official Docker
image</a>. This image is built from the
<a href="https://github.com/SUSE/Portus/tree/master/docker">main</a> repository. Long story
short, this image downloads the <a href="https://build.opensuse.org/project/show/Virtualization:containers:Portus">official
RPM</a>
and provides an <code class="highlighter-rouge">init</code> script which is good for any kind of container
deployment.</p>

<p>This Docker image has in turn a tag policy worth mentioning:</p>

<ul>
  <li><code class="highlighter-rouge">head</code>: Portus’ master branch packaged and curated as if it was
production-ready. This is convenient for people that want to be on the
bleeding edge and want to test the latest features. It’s not recommended to
use this tag in production since it might break every now and then.</li>
  <li><code class="highlighter-rouge">latest</code>: the latest stable release.</li>
  <li>Version-specific tags (e.g. <code class="highlighter-rouge">2.3</code>). We recommend using these tags for
production clusters.</li>
</ul>

<p>Once you have decided to use the Docker image for your deployment, you have to
be aware of the following requirements:</p>

<ul>
  <li>Configurable values follow a naming policy described
<a href="/docs/Configuring-Portus.html">here</a>. This page will clarify any doubts you
may have on how to configure Portus. There are some configurable values which
are important on production environments:
    <ul>
      <li><code class="highlighter-rouge">PORTUS_MACHINE_FQDN_VALUE</code>: this defines the FQDN to be used. This is
important because the JWT token passed between Portus and the registry
relies on this setting. The default value for this will most probably <em>not</em>
work for you.</li>
      <li><code class="highlighter-rouge">PORTUS_CHECK_SSL_USAGE_ENABLED</code>: this is set to true by default, but you
might want to set it to false in case you are not using SSL.</li>
      <li><code class="highlighter-rouge">RAILS_SERVE_STATIC_FILES</code>: whether you want Portus to serve assets directly
or not. You can read more about this <a href="/docs/assets.html">here</a>.</li>
      <li><code class="highlighter-rouge">CCONFIG_PREFIX</code>: set this to <code class="highlighter-rouge">PORTUS</code> just to be sure (it shouldn’t be
necessary, but some deployments have had weird bugs because of this in the
past).</li>
      <li><code class="highlighter-rouge">PORTUS_BACKGROUND</code>: set to <code class="highlighter-rouge">true</code> if the container has to execute the
<a href="/docs/background.html">background process</a> instead of the main Portus
process.</li>
    </ul>
  </li>
  <li>Check the environment variables to be used for the
<a href="/docs/database.html">database</a>.</li>
  <li>You have to provide three environment variables which contain secret data
(read <a href="/docs/secrets.html">this page</a> in order to know how to manage these
secrets in production):
    <ul>
      <li><code class="highlighter-rouge">PORTUS_SECRET_KEY_BASE</code>: which will be used for to encrypt and sign
sessions (you can read more about this
<a href="http://guides.rubyonrails.org/security.html">here</a>).</li>
      <li><code class="highlighter-rouge">PORTUS_KEY_PATH</code>: used to generate the private key for JWT requests (how
Portus communicates with the Registry safely).</li>
      <li><code class="highlighter-rouge">PORTUS_PASSWORD</code>: the password of the special <code class="highlighter-rouge">portus</code> user.</li>
    </ul>
  </li>
</ul>

<p>Finally, you might want to take a look at some of the examples based on
docker-compose that we have implemented
<a href="https://github.com/SUSE/Portus/tree/master/examples/compose">here</a>.</p>

<h3 id="kubernetes-and-helm">Kubernetes and Helm</h3>

<p>Unless you are managing Docker containers manually, or you want to deploy
everything in a single machine (in which case you might probably want to check
<a href="https://github.com/SUSE/Portus/tree/master/examples/compose">this examples</a>),
you will use a Container Orchestrator. There are a wide variety of them, but in
openSUSE and SUSE we quite are invested in Kubernetes (see the <a href="https://github.com/kubic-project">kubic
project</a>).</p>

<p>Moreover, to maintain Kubernetes applications the community has developed
<a href="https://helm.sh">Helm</a>. Because of this, we have been working on proper Helm
charts to deploy Portus in your Kubernetes cluster. We are working on pushing
these charts into the main repository, but for now you can use the charts from
<a href="https://github.com/kubic-project/caasp-services/tree/master/contrib/helm-charts/portus">this
repository</a>.</p>

<h3 id="development">Development</h3>

<p>If you simply want to explore Portus and play with it, using the development
environment might be a good fit. A quick way to start a development version of
Portus is to clone the <a href="https://github.com/SUSE/Portus">git repo</a> and perform
the following:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker-compose up
</code></pre></div></div>

<p>For more information on development environments, check our
<a href="https://github.com/SUSE/Portus/wiki#developmentplayground-environments">wiki</a>.</p>

<h2 id="bare-metal">Bare metal</h2>

<p>You can also deploy Portus in a more traditional way: simply installing the code
somewhere and setup a load balancer (we recommend the
<a href="/docs/deploy.html#containerized">containerized</a> though). In order to install
Portus, you have two options:</p>

<ol>
  <li>You clone the <a href="https://github.com/SUSE/Portus">git repository</a>.</li>
  <li>You install the
<a href="https://build.opensuse.org/project/show/Virtualization:containers:Portus">RPM</a>
if you are using openSUSE or SLE.</li>
</ol>

<p>After that, you will have to setup everything as any other Rails
application. You have an example of an <a href="https://github.com/SUSE/Portus/blob/master/examples/compose/nginx/nginx.conf">NGinx configuration
here</a>. This
example relies on Puma, and you might want to use the <a href="https://github.com/SUSE/Portus/blob/master/config/puma.rb">default Puma
configuration</a>. The
<a href="https://github.com/SUSE/Portus/blob/master/docker/init">init file</a> from the
official Docker image might give you some ideas on the environment variables to
be set before starting the whole thing.</p>

              </article>
            </div>
          </section>
        </div>
      </div>
      <aside class="hidden-xs hidden-sm content-list">
  <ul class="topics">
    <li>Documentation</li>
    <ul class="subtopics">
      
      
        
        <li>
          <a href="/docs/first-steps.html">
            Docker and Portus for newcomers
          </a>
        </li>
        
      
        
        <li>
          <a href="/docs/Configuring-Portus.html">
            Configuring Portus
          </a>
        </li>
        
      
        
        <li>
          <a href="/docs/database.html">
            Configuring the database
          </a>
        </li>
        
      
        
        <li>
          <a href="/docs/How-to-setup-secure-registry.html">
            Configuring a secure private registry
          </a>
        </li>
        
      
        
        <li>
          <a href="/docs/deploy.html">
            Deploying Portus
          </a>
        </li>
        
      
        
        <li>
          <a href="/docs/Configuring-the-registry.html">
            Portus and your private registry
          </a>
        </li>
        
      
        
        <li>
          <a href="/docs/assets.html">
            Managing assets
          </a>
        </li>
        
      
        
        <li>
          <a href="/docs/secrets.html">
            Using secrets
          </a>
        </li>
        
      
        
        <li>
          <a href="/docs/API.html">
            Portus REST API
          </a>
        </li>
        
      
        
        <li>
          <a href="/docs/background.html">
            The background process
          </a>
        </li>
        
      
        
        <li>
          <a href="/docs/portusctl.html">
            portusctl
          </a>
        </li>
        
      
        
        <li>
          <a href="/docs/upgrading-portus.html">
            Upgrading Portus
          </a>
        </li>
        
      
        
        <li>
          <a href="/docs/versions.html">
            Supported Docker Versions
          </a>
        </li>
        
      
        
        <li>
          <a href="/docs/debugging.html">
            Debugging Portus
          </a>
        </li>
        
      
        
        <li>
          <a href="/docs/how_we_release.html">
            Portus Releases
          </a>
        </li>
        
      
        
      
        
        <li>
          <a href="/docs/release-schedule.html">
            Release schedule
          </a>
        </li>
        
      
        
        <li>
          <a href="/docs/FAQ.html">
            FAQ
          </a>
        </li>
        
      
    </ul>
    <li>Features</li>
    <ul class="subtopics">
      
      
        <li>
          <a href="/features/1_Synchronizing-the-Registry-and-Portus.html">
            Synchronizing the Registry and Portus
          </a>
        </li>
      
        <li>
          <a href="/features/2_LDAP-support.html">
            LDAP support
          </a>
        </li>
      
        <li>
          <a href="/features/3_teams_namespaces_and_users.html">
            Teams, namespaces and users
          </a>
        </li>
      
        <li>
          <a href="/features/4_audit.html">
            Audit
          </a>
        </li>
      
        <li>
          <a href="/features/5_search.html">
            Search
          </a>
        </li>
      
        <li>
          <a href="/features/6_security_scanning.html">
            Security scanning
          </a>
        </li>
      
        <li>
          <a href="/features/removing_images.html">
            Removing images and tags
          </a>
        </li>
      
        <li>
          <a href="/features/6_starring.html">
            Starring repositories
          </a>
        </li>
      
        <li>
          <a href="/features/7_disabling_users.html">
            Removing/Disabling users
          </a>
        </li>
      
        <li>
          <a href="/features/anonymous_browsing.html">
            Anonymous browsing
          </a>
        </li>
      
        <li>
          <a href="/features/8_locking.html">
            Locking accounts for safety reasons
          </a>
        </li>
      
        <li>
          <a href="/features/9_recovering_password.html">
            Recovering the password
          </a>
        </li>
      
        <li>
          <a href="/features/disabling_signup.html">
            Disabling the sign up form
          </a>
        </li>
      
        <li>
          <a href="/features/oauth.html">
            OAuth and OpenID Connect support
          </a>
        </li>
      
        <li>
          <a href="/features/application_tokens.html">
            Application tokens
          </a>
        </li>
      
        <li>
          <a href="/features/display_name.html">
            Display name
          </a>
        </li>
      
        <li>
          <a href="/features/health.html">
            Health checking
          </a>
        </li>
      
    </ul>
  </ul>
  <div class="credits">
    <div class="text-center" lang="en">Created with <i class='fa fa-heart secondary-colour'></i> by the SUSE team</div>
  </div>
</aside>

      <div class="visible-xs visible-sm credits">
        <div class="text-center" lang="en">Created with <i class='fa fa-heart secondary-colour'></i> by the SUSE team</div>
      </div>
    </div>
  </body>
</html>
